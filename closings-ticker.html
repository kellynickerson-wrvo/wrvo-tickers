<style>
  /* Main Container */
  #ticker-bar {
    display: flex;
    width: 100%;
    height: 50px; /* Adjusted for better visibility */
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    overflow: hidden;
    margin: 10px 0;
  }

  /* Red Label Section (Left side) */
  #ticker-label {
    background-color: #bd2100; /* Matching the orange-red in your image */
    color: #ffffff;
    font-weight: 800;
    text-transform: uppercase;
    padding: 0 25px;
    display: flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
    z-index: 10;
    font-size: 15px;
    letter-spacing: 1px;
    border-right: 2px solid #ffffff;
  }

  /* Dark Blue Ticker Section (Right side) */
  #ticker-main {
    background-color: #204180; /* Deep Navy Blue */
    flex-grow: 1;
    position: relative;
    display: flex;
    align-items: center;
    overflow: hidden;
  }

  /* The Scrolling Track */
  #ticker-track {
    display: flex;
    white-space: nowrap;
    padding-left: 100%;
    animation: marquee 180s linear infinite; /* Adjust speed here (higher = slower) */
  }

  .ticker-item {
    color: #ffffff;
    font-size: 18px;
    margin-right: 80px;
    display: flex;
    align-items: center;
  }

  .ticker-school {
    font-weight: bold;
    margin-right: 8px;
  }

  .ticker-status {
    color: #ffffff;
    font-weight: 400;
  }

  /* Animation */
  @keyframes marquee {
    0% { transform: translateX(0); }
    100% { transform: translateX(-100%); }
  }

  /* Pause on hover so people can read a specific line */
  #ticker-main:hover #ticker-track {
    animation-play-state: paused;
  }
</style>

<div id="ticker-bar">
  <div id="ticker-label">Closings & Delays</div>
  <div id="ticker-main">
    <div id="ticker-track">
      <span class="ticker-item">Fetching latest updates...</span>
    </div>
  </div>
</div>

<script>
async function startTicker() {
  // YOUR ACTUAL DATA URL
  const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRijmTFMmlSUW6T-q2Yt_0QW0Y_2BLXVyxmX49Grb8gZFfJ0oh7lzdSPON1F0QRHum75rkoEJrLdb-b/pub?output=csv";
  const track = document.getElementById('ticker-track');
  
  try {
    // Fetch and bypass cache to get real-time data
    const response = await fetch(`${csvUrl}&t=${new Date().getTime()}`);
    const text = await response.text();
    
    // Split into rows
    const rows = text.split(/\r?\n/).filter(row => row.trim() !== "");
    
    let tickerHtml = "";
    let entriesFound = 0;

    // Start at index 1 to skip the header row (School, Status)
    for (let i = 1; i < rows.length; i++) {
      // Split columns by comma, handling potential quotes
      const cols = rows[i].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
      
      if (cols.length >= 2) {
        const school = cols[0].replace(/"/g, "").trim();
        const status = cols[1].replace(/"/g, "").trim();

        if (school && status) {
          tickerHtml += `
            <span class="ticker-item">
              <span class="ticker-school">${school}:</span> 
              <span class="ticker-status">${status}</span>
            </span>`;
          entriesFound++;
        }
      }
    }

    if (entriesFound > 0) {
      track.innerHTML = tickerHtml;
    } else {
      track.innerHTML = `<span class="ticker-item">No active closings or delays reported at this time.</span>`;
    }

  } catch (err) {
    track.innerHTML = `<span class="ticker-item">Updates temporarily unavailable.</span>`;
    console.error("Ticker Error:", err);
  }
}

// Run immediately
startTicker();
// Refresh every 5 minutes automatically without reloading the page
setInterval(startTicker, 300000);
</script>
